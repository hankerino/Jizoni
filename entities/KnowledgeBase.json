{
  "name": "KnowledgeBase",
  "type": "object",
  "properties": {
    "project_id": {
      "type": ["string", "null"],
      "description": "Associated project ID (null for global knowledge)"
    },
    "title": {
      "type": "string",
      "description": "Document title"
    },
    "description": {
      "type": "string",
      "description": "Brief description of the document"
    },
    "category": {
      "type": "string",
      "enum": ["standards", "templates", "regulations", "lessons_learned", "procedures", "specifications", "other"],
      "default": "other",
      "description": "Document category"
    },
    "file_url": {
      "type": "string",
      "description": "URL to the uploaded file"
    },
    "content_summary": {
      "type": "string",
      "description": "AI-generated summary of the document content"
    },
    "tags": {
      "type": "array",
      "items": {"type": "string"},
      "description": "Tags for easier searching"
    },
    "is_active": {
      "type": "boolean",
      "default": true,
      "description": "Whether to include in AI context"
    }
  },
  "required": ["title", "category", "file_url"],
  "rls": {
    "read": {
      "$or": [
        {"created_by": "{{user.email}}"},
        {"project_id": null},
        {"user_condition": {"role": "admin"}}
      ]
    },
    "write": {
      "$or": [
        {"created_by": "{{user.email}}"},
        {"user_condition": {"role": "admin"}}
      ]
    }
  }
}
